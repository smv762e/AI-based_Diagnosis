{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nexport let CreateSolicitudComponent = class CreateSolicitudComponent {\n  constructor(requestService, medicalService, snackbar, router, route, _location) {\n    this.requestService = requestService;\n    this.medicalService = medicalService;\n    this.snackbar = snackbar;\n    this.router = router;\n    this.route = route;\n    this._location = _location;\n    this.request = {\n      id: undefined,\n      drugs: '',\n      route: '',\n      medico: undefined,\n      accepted: false\n    };\n    this.create = true;\n    this.requestId = 0;\n  }\n  ngOnInit() {\n    if (this.route.snapshot.paramMap.has('id')) {\n      this.requestId = Number(this.route.snapshot.paramMap.get('id'));\n      this.create = false;\n    }\n    if (!this.create) {\n      this.requestService.getRequest(this.requestId).subscribe({\n        next: data => {\n          this.request = data; // Assuming the response structure matches Request\n        },\n\n        error: e => {\n          this.snackbar.open('Error communicating with the server', '', {\n            duration: 3000\n          });\n        }\n      });\n    }\n  }\n  back() {\n    this._location.back();\n  }\n  onSubmit(request) {\n    if (this.create) {\n      const medicoId = request.medico;\n      if (typeof medicoId === 'number') {\n        this.medicalService.getMedicalById(medicoId).subscribe({\n          next: medicoData => {\n            request.medico = medicoData;\n            this.requestService.createRequest(request).subscribe({\n              next: () => {\n                this.router.navigateByUrl('/request');\n                this.snackbar.open('Solicitud created ', '', {\n                  duration: 3000\n                });\n              },\n              error: e => {\n                this.snackbar.open('Error creating the solicitud: ' + e.error, '', {\n                  duration: 3000\n                });\n              }\n            });\n          },\n          error: error => {\n            this.snackbar.open('Error fetching medical professional: ' + error, '', {\n              duration: 3000\n            });\n          }\n        });\n      } else {\n        this.snackbar.open('Error: Medico ID is not a number', '', {\n          duration: 3000\n        });\n      }\n    } else {\n      this.requestService.updateRequest(request).subscribe({\n        next: () => {\n          this.router.navigateByUrl('/request');\n          this.snackbar.open('Solicitud updated ', '', {\n            duration: 3000\n          });\n        },\n        error: e => {\n          this.snackbar.open('Error updating the solicitud: ' + e.error, '', {\n            duration: 3000\n          });\n        }\n      });\n    }\n  }\n};\nCreateSolicitudComponent = __decorate([Component({\n  selector: 'app-create-solicitud',\n  templateUrl: './create-solicitud.component.html',\n  styleUrls: ['./create-solicitud.component.css']\n})], CreateSolicitudComponent);","map":{"version":3,"names":["Component","CreateSolicitudComponent","constructor","requestService","medicalService","snackbar","router","route","_location","request","id","undefined","drugs","medico","accepted","create","requestId","ngOnInit","snapshot","paramMap","has","Number","get","getRequest","subscribe","next","data","error","e","open","duration","back","onSubmit","medicoId","getMedicalById","medicoData","createRequest","navigateByUrl","updateRequest","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\sermv\\Desktop\\4ºIngeniería\\Web\\HWA\\frontend\\frontendAlt\\src\\app\\create-solicitud\\create-solicitud.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { RequestService } from '../services/request.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Request } from '../request';\nimport { Location } from '@angular/common';\nimport { MedicalService } from '../services/medical.service';\n\n@Component({\n  selector: 'app-create-solicitud',\n  templateUrl: './create-solicitud.component.html',\n  styleUrls: ['./create-solicitud.component.css']\n})\nexport class CreateSolicitudComponent {\n\n  request: Request = {\n    id: undefined,\n    drugs: '',\n    route: '',\n    medico: undefined,\n    accepted: false\n  };\n  create: boolean = true;\n  requestId: number = 0;\n\n  constructor(\n    private requestService: RequestService,\n    private medicalService: MedicalService,\n    private snackbar: MatSnackBar,\n    private router: Router,\n    private route: ActivatedRoute,\n    private _location: Location\n  ) { }\n\n  ngOnInit(): void {\n    if (this.route.snapshot.paramMap.has('id')) {\n      this.requestId = Number(this.route.snapshot.paramMap.get('id'));\n      this.create = false;\n    }\n\n    if (!this.create) {\n      this.requestService.getRequest(this.requestId).subscribe({\n        next: (data: any) => {\n          this.request = data; // Assuming the response structure matches Request\n        },\n        error: (e: any) => {\n          this.snackbar.open('Error communicating with the server', '', {\n            duration: 3000\n          });\n        }\n      });\n    }\n  }\n\n  back() {\n    this._location.back();\n  }\n\n  onSubmit(request: Request) {\n    if (this.create) {\n      const medicoId = request.medico;\n\n      if (typeof medicoId === 'number') {\n        this.medicalService.getMedicalById(medicoId).subscribe({\n          next: (medicoData: any) => {\n            request.medico = medicoData;\n            this.requestService.createRequest(request).subscribe({\n              next: () => {\n                this.router.navigateByUrl('/request');\n                this.snackbar.open('Solicitud created ', '', {\n                  duration: 3000\n                });\n              },\n              error: (e: any) => {\n                this.snackbar.open('Error creating the solicitud: ' + e.error, '', {\n                  duration: 3000\n                });\n              }\n            });\n          },\n          error: (error: any) => {\n            this.snackbar.open('Error fetching medical professional: ' + error, '', {\n              duration: 3000\n            });\n          }\n        });\n      } else {\n        this.snackbar.open('Error: Medico ID is not a number', '', {\n          duration: 3000\n        });\n      }\n    } else {\n      this.requestService.updateRequest(request).subscribe({\n        next: () => {\n          this.router.navigateByUrl('/request');\n          this.snackbar.open('Solicitud updated ', '', {\n            duration: 3000\n          });\n        },\n        error: (e: any) => {\n          this.snackbar.open('Error updating the solicitud: ' + e.error, '', {\n            duration: 3000\n          });\n        }\n      });\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}